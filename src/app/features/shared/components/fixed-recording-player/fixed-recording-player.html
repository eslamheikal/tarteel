@if (recording && isVisible) {
<div class="fixed-recording-player container">
  <div class="player-content">

    <!-- Recording Info -->
    <div class="recording-info">
      <h4 class="recording-title">{{ recording.title }}</h4>
      <div class="recording-actions">
        <button class="action-btn download-btn" (click)="downloadRecording()" title="تحميل السورة">
          <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
          </svg>
          <span class="action-label">تحميل</span>
        </button>
        <button class="action-btn share-btn" (click)="shareRecording()" title="مشاركة السورة">
          <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"/>
          </svg>
          <span class="action-label">مشاركة</span>
        </button>
      </div>
    </div>

    <!-- Volume Control -->
    <div class="volume-section">
      <div class="volume-control-wrapper">
        <button class="volume-btn" (click)="toggleVolumeSlider()" title="{{ (isMuted || volume === 0) ? 'إلغاء كتم الصوت' : 'كتم الصوت' }}">
          <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path *ngIf="isMuted || volume === 0" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"/>
            <path *ngIf="isMuted || volume === 0" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"/>
            <path *ngIf="!(isMuted || volume === 0)" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 14.142M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"/>
          </svg>
        </button>
        @if (showVolumeSlider) {
        <div class="volume-slider-dropdown" (click)="onVolumeSliderClick($event)">
          <div class="volume-slider-container-vertical">
            <input type="range" class="volume-slider-vertical" min="0" max="100" [value]="volume"
              (input)="onVolumeChange($event)">
            <div class="volume-percentage">{{ volume }}%</div>
          </div>
        </div>
        }
      </div>
      <button class="repeat-btn" (click)="toggleRepeat()" [class.active]="repeatMode !== 'none'" title="{{ repeatMode === 'none' ? 'تفعيل التكرار' : 'إلغاء التكرار' }}">
        <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <!-- Repeat Icon -->
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
          
          <!-- Strike through line when repeat is off -->
          <path *ngIf="repeatMode === 'none'" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6" stroke="red"/>
        </svg>
      </button>
    </div>

    <!-- Progress Bar -->
    <div class="progress-section">
      <div class="progress-container">
        <span class="total-time">{{ formatTime(totalTime) }}</span>
        <div class="progress-bar-container">
          <div class="progress-bar" (click)="seekTo($event)">
            <div class="progress-fill" [style.width.%]="progressPercentage"></div>
          </div>
        </div>
        <span class="current-time">{{ formatTime(currentTime) }}</span>
      </div>
    </div>

    <!-- Play/Pause Button -->
    <div class="play-section">
      <button class="play-pause-btn" (click)="togglePlayPause()" title="{{ isPlaying ? 'إيقاف' : 'تشغيل' }}">
        <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <!-- Play Icon -->
          <path *ngIf="!isPlaying" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5v14l11-7z"/>
          
          <!-- Pause Icon -->
          <g *ngIf="isPlaying">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 4h4v16H6z"/>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 4h4v16h-4z"/>
          </g>
        </svg>
      </button>
    </div>

  </div>
</div>
}